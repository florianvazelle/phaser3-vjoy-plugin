{"version":3,"sources":["webpack://VJoyPlugin/webpack/universalModuleDefinition","webpack://VJoyPlugin/webpack/bootstrap","webpack://VJoyPlugin/./main.js","webpack://VJoyPlugin/./Joystick.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","m","VJoyPlugin","scene","pluginManager","joysticks","registerGameObject","addJoystick","bind","config","add","settings","joystickClass","Phaser","Plugins","ScenePlugin","joystick","Joystick","this","push","eventEmitter","systems","events","on","update","destroy","forEach","game","cursors","up","down","left","right","initialPoint","x","y","singleDirection","undefined","maxDistanceInPixels","device","console","log","imageGroup","sprite","sprites","cap","i","body","base","active","remove","position","visible","setScrollFactor","pointers","pointer","deltaX","deltaY","dist","Math","hypot","abs","angle","atan2","cos","sin","index","input","manager","setDirection","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","n","object","property","prototype","hasOwnProperty","call","p","s","moduleId","l","modules"],"mappings":"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","file":"VJoyPlugin.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"VJoyPlugin\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VJoyPlugin\"] = factory();\n\telse\n\t\troot[\"VJoyPlugin\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import Joystick from './Joystick';\n\nexport default class VJoyPlugin extends Phaser.Plugins.ScenePlugin {\n\n    constructor(scene, pluginManager) {\n        super(scene, pluginManager);\n\n        this.joysticks = [];\n\n        // Register our new Game Object type\n        pluginManager.registerGameObject('joystick', this.addJoystick.bind(this), config => {\n            return this.add(\n                config.settings,\n                config.joystickClass\n                );\n            });\n    }\n\n    addJoystick(settings, joystickClass) {\n        if (!joystickClass) {\n            joystickClass = Joystick;\n        }\n\n        const joystick = new joystickClass(this.scene, settings);\n\n        this.joysticks.push(joystick)\n\n        return joystick;\n    }\n\n    /**\n     * If this is a Scene Plugin (i.e. installed into a Scene) then this method is called when the Scene boots.\n     * By this point the plugin properties `scene` and `systems` will have already been set.\n     * In here you can listen for Scene events and set-up whatever you need for this plugin to run.\n     * @returns {void}\n     */\n    boot() {\n        const eventEmitter = this.systems.events;\n\n        eventEmitter.on('update', this.update, this);\n        eventEmitter.on('destroy', this.destroy, this);\n    }\n\n    /**\n     * Internal update method, called by the PluginManager.\n     *\n     * @protected\n     * @returns {void}\n     */\n    update() {\n        this.joysticks.forEach(joystick => {\n            joystick.update();\n        });\n    }\n\n    /**\n     * Destroys this Weapon.\n     * You must release everything in here, all references, all objects, free it all up.\n     * @returns {void}\n     */\n    destroy() {\n        this.pluginManager = null;\n        this.game = null;\n        this.scene = null;\n        this.systems = null;\n    }\n}","export default class Joystick {\n\n    constructor(scene, settings) {\n        this.scene = scene;\n\n        this.cursors = {\n            up: false,\n            down: false,\n            left: false,\n            right: false\n        };\n\n        this.initialPoint = {\n            x: 0,\n            y: 0\n        };\n\n        this.settings = {\n            singleDirection: (settings.singleDirection === undefined || settings.singleDirection === null) ? true : settings.singleDirection,\n            maxDistanceInPixels: (settings.maxDistanceInPixels === undefined || settings.maxDistanceInPixels === null) ? 200 : settings.maxDistanceInPixels,\n            device: (settings.device === undefined || settings.device === null) ? 0 : settings.device\n        };\n\n        console.log(settings, this.settings)\n\n        this.imageGroup = [];\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.cap));\n\n        for (var i = 0; i < this.settings.maxDistanceInPixels; i += 100) {\n            this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.body));\n        }\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.base));\n        \n        this.active = true;\n        \n        this.remove();\n    }\n    \n    /**\n     * For create the Joystick\n     * @method create\n     * @param {Array} - Coordinates of pointer.\n     */\n    create({ position }) {\n        if (!this.active) {\n            this.active = true;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = true;\n                sprite.setScrollFactor(0);\n    \n                sprite.x = position.x;\n                sprite.y = position.y;\n                \n            });\n    \n            this.initialPoint = {\n                x: position.x,\n                y: position.y\n            };\n        }\n    }\n\n    /**\n     * To get the cursors attribute\n     * @method getCursors\n     * @return {Object}\n     */\n    getCursors() {\n        return this.cursors;\n    }\n    \n    /**\n     * To define cursors\n     * @method setDirection\n     * @param {Array} - Coordinates of pointer (A Pointer object encapsulates both mouse and touch input within Phaser.)\n     */\n    setDirection(pointers) {\n        if (!this.active) {\n            return;\n        }\n        \n        var pointer = pointers[this.settings.device].position;\n        \n        var deltaX = pointer.x - this.initialPoint.x;\n        var deltaY = pointer.y - this.initialPoint.y;\n        \n        var dist = Math.hypot(deltaX, deltaY);\n        var maxDistanceInPixels = this.settings.maxDistanceInPixels;\n        \n        if (this.settings.singleDirection) {\n            if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                deltaY = 0;\n                pointer.y = this.initialPoint.y;\n            } else {\n                deltaX = 0;\n                pointer.x = this.initialPoint.x;\n            }\n        }\n        \n        var angle = Math.atan2(deltaY, deltaX);\n        \n        if (dist > maxDistanceInPixels) {\n            deltaX = Math.cos(angle) * maxDistanceInPixels;\n            deltaY = Math.sin(angle) * maxDistanceInPixels;\n        }\n        \n        this.cursors = {\n            up: (deltaY < 0),\n            down: (deltaY > 0),\n            left: (deltaX < 0),\n            right: (deltaX > 0)\n        }\n        \n        this.imageGroup.forEach(function (sprite, index) {\n            sprite.x = this.initialPoint.x + (deltaX) * index / 3;\n            sprite.y = this.initialPoint.y + (deltaY) * index / 3;\n        }, this);\n    }\n    \n    update () {\n        var pointers = this.scene.input.manager.pointers;\n        this.setDirection(pointers);\n    }\n\n    /**\n     * For remove the Joystick\n     * @method remove\n     */\n    remove() {\n        if (this.active) {\n            this.active = false;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = false;\n            });\n\n            this.cursors = {\n                up: false,\n                down: false,\n                left: false,\n                right: false\n            };\n        }\n    }\n}"],"sourceRoot":""}