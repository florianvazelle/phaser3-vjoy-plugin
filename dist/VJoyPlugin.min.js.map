{"version":3,"sources":["webpack://VJoyPlugin/webpack/universalModuleDefinition","webpack://VJoyPlugin/webpack/bootstrap","webpack://VJoyPlugin/./main.js","webpack://VJoyPlugin/./Joystick.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","m","VJoyPlugin","scene","pluginManager","joysticks","registerGameObject","addJoystick","bind","config","add","settings","joystickClass","Phaser","Plugins","ScenePlugin","joystick","Joystick","this","push","eventEmitter","systems","events","on","update","destroy","forEach","game","cursors","deltaX","deltaY","initialPoint","x","y","singleDirection","undefined","maxDistanceInPixels","device","imageGroup","sprite","sprites","cap","i","body","base","active","remove","position","visible","setScrollFactor","pointers","pointer","dist","Math","hypot","abs","angle","atan2","cos","sin","index","input","manager","setDirection","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","n","object","property","prototype","hasOwnProperty","call","p","s","moduleId","l","modules"],"mappings":"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","file":"VJoyPlugin.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"VJoyPlugin\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VJoyPlugin\"] = factory();\n\telse\n\t\troot[\"VJoyPlugin\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import Joystick from './Joystick';\n\nexport default class VJoyPlugin extends Phaser.Plugins.ScenePlugin {\n\n    constructor(scene, pluginManager) {\n        super(scene, pluginManager);\n\n        this.joysticks = [];\n\n        // Register our new Game Object type\n        pluginManager.registerGameObject('joystick', this.addJoystick.bind(this), config => {\n            return this.add(\n                config.settings,\n                config.joystickClass\n                );\n            });\n    }\n\n    addJoystick(settings, joystickClass) {\n        if (!joystickClass) {\n            joystickClass = Joystick;\n        }\n\n        const joystick = new joystickClass(this.scene, settings);\n\n        this.joysticks.push(joystick)\n\n        return joystick;\n    }\n\n    /**\n     * If this is a Scene Plugin (i.e. installed into a Scene) then this method is called when the Scene boots.\n     * By this point the plugin properties `scene` and `systems` will have already been set.\n     * In here you can listen for Scene events and set-up whatever you need for this plugin to run.\n     * @returns {void}\n     */\n    boot() {\n        const eventEmitter = this.systems.events;\n\n        eventEmitter.on('update', this.update, this);\n        eventEmitter.on('destroy', this.destroy, this);\n    }\n\n    /**\n     * Internal update method, called by the PluginManager.\n     *\n     * @protected\n     * @returns {void}\n     */\n    update() {\n        this.joysticks.forEach(joystick => {\n            joystick.update();\n        });\n    }\n\n    /**\n     * Destroys this Weapon.\n     * You must release everything in here, all references, all objects, free it all up.\n     * @returns {void}\n     */\n    destroy() {\n        this.pluginManager = null;\n        this.game = null;\n        this.scene = null;\n        this.systems = null;\n    }\n}","export default class Joystick {\n\n    constructor(scene, settings) {\n        this.scene = scene;\n\n        this.cursors = {\n            deltaX: 0,\n            deltaY: 0\n        };\n\n        this.initialPoint = {\n            x: 0,\n            y: 0\n        };\n\n        this.settings = {\n            singleDirection: (settings.singleDirection === undefined || settings.singleDirection === null) ? true : settings.singleDirection,\n            maxDistanceInPixels: (settings.maxDistanceInPixels === undefined || settings.maxDistanceInPixels === null) ? 200 : settings.maxDistanceInPixels,\n            device: (settings.device === undefined || settings.device === null) ? 0 : settings.device\n        };\n\n        this.imageGroup = [];\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.cap));\n\n        for (var i = 0; i < this.settings.maxDistanceInPixels; i += 100) {\n            this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.body));\n        }\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.base));\n        \n        this.active = true;\n        \n        this.remove();\n    }\n    \n    /**\n     * For create the Joystick\n     * @method create\n     * @param {Array} - Coordinates of pointer.\n     */\n    create({ position }) {\n        if (!this.active) {\n            this.active = true;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = true;\n                sprite.setScrollFactor(0);\n    \n                sprite.x = position.x;\n                sprite.y = position.y;\n                \n            });\n    \n            this.initialPoint = {\n                x: position.x,\n                y: position.y\n            };\n        }\n    }\n\n    /**\n     * To get the cursors attribute\n     * @method getCursors\n     * @return {Object}\n     */\n    getCursors() {\n        return this.cursors;\n    }\n    \n    /**\n     * To define cursors\n     * @method setDirection\n     * @param {Array} - Coordinates of pointer (A Pointer object encapsulates both mouse and touch input within Phaser.)\n     */\n    setDirection(pointers) {\n        if (!this.active) {\n            return;\n        }\n        \n        const pointer = pointers[this.settings.device].position;\n        \n        var deltaX = pointer.x - this.initialPoint.x;\n        var deltaY = pointer.y - this.initialPoint.y;\n        \n        const dist = Math.hypot(deltaX, deltaY);\n        const maxDistanceInPixels = this.settings.maxDistanceInPixels;\n        \n        if (this.settings.singleDirection) {\n            if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                deltaY = 0;\n                pointer.y = this.initialPoint.y;\n            } else {\n                deltaX = 0;\n                pointer.x = this.initialPoint.x;\n            }\n        }\n        \n        const angle = Math.atan2(deltaY, deltaX);\n        \n        if (dist > maxDistanceInPixels) {\n            deltaX = Math.cos(angle) * maxDistanceInPixels;\n            deltaY = Math.sin(angle) * maxDistanceInPixels;\n        }\n        \n        this.cursors = { deltaX, deltaY };\n        \n        this.imageGroup.forEach(function (sprite, index) {\n            sprite.x = this.initialPoint.x + (deltaX) * index / 3;\n            sprite.y = this.initialPoint.y + (deltaY) * index / 3;\n        }, this);\n    }\n    \n    update () {\n        var pointers = this.scene.input.manager.pointers;\n        this.setDirection(pointers);\n    }\n\n    /**\n     * For remove the Joystick\n     * @method remove\n     */\n    remove() {\n        if (this.active) {\n            this.active = false;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = false;\n            });\n\n            this.cursors = {\n                deltaX: 0,\n                deltaY: 0\n            };\n        }\n    }\n}"],"sourceRoot":""}