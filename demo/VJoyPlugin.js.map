{"version":3,"sources":["webpack://VJoyPlugin/webpack/universalModuleDefinition","webpack://VJoyPlugin/webpack/bootstrap","webpack://VJoyPlugin/./main.js","webpack://VJoyPlugin/./Joystick.js"],"names":["VJoyPlugin","scene","pluginManager","joysticks","registerGameObject","addJoystick","bind","config","add","settings","joystickClass","Joystick","joystick","push","eventEmitter","systems","events","on","update","destroy","forEach","game","Phaser","Plugins","ScenePlugin","cursors","deltaX","deltaY","initialPoint","x","y","singleDirection","undefined","maxDistanceInPixels","device","imageGroup","sprite","sprites","cap","i","body","base","active","remove","position","visible","setScrollFactor","pointers","pointer","dist","Math","hypot","abs","angle","atan2","cos","sin","index","input","manager","setDirection"],"mappings":"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","file":"VJoyPlugin.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"VJoyPlugin\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VJoyPlugin\"] = factory();\n\telse\n\t\troot[\"VJoyPlugin\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import Joystick from './Joystick';\n\nexport default class VJoyPlugin extends Phaser.Plugins.ScenePlugin {\n\n    constructor(scene, pluginManager) {\n        super(scene, pluginManager);\n\n        this.joysticks = [];\n\n        // Register our new Game Object type\n        pluginManager.registerGameObject('joystick', this.addJoystick.bind(this), config => {\n            return this.add(\n                config.settings,\n                config.joystickClass\n                );\n            });\n    }\n\n    addJoystick(settings, joystickClass) {\n        if (!joystickClass) {\n            joystickClass = Joystick;\n        }\n\n        const joystick = new joystickClass(this.scene, settings);\n\n        this.joysticks.push(joystick)\n\n        return joystick;\n    }\n\n    /**\n     * If this is a Scene Plugin (i.e. installed into a Scene) then this method is called when the Scene boots.\n     * By this point the plugin properties `scene` and `systems` will have already been set.\n     * In here you can listen for Scene events and set-up whatever you need for this plugin to run.\n     * @returns {void}\n     */\n    boot() {\n        const eventEmitter = this.systems.events;\n\n        eventEmitter.on('update', this.update, this);\n        eventEmitter.on('destroy', this.destroy, this);\n    }\n\n    /**\n     * Internal update method, called by the PluginManager.\n     *\n     * @protected\n     * @returns {void}\n     */\n    update() {\n        this.joysticks.forEach(joystick => {\n            joystick.update();\n        });\n    }\n\n    /**\n     * Destroys this Weapon.\n     * You must release everything in here, all references, all objects, free it all up.\n     * @returns {void}\n     */\n    destroy() {\n        this.pluginManager = null;\n        this.game = null;\n        this.scene = null;\n        this.systems = null;\n    }\n}","export default class Joystick {\n\n    constructor(scene, settings) {\n        this.scene = scene;\n\n        this.cursors = {\n            deltaX: 0,\n            deltaY: 0\n        };\n\n        this.initialPoint = {\n            x: 0,\n            y: 0\n        };\n\n        this.settings = {\n            singleDirection: (settings.singleDirection === undefined || settings.singleDirection === null) ? true : settings.singleDirection,\n            maxDistanceInPixels: (settings.maxDistanceInPixels === undefined || settings.maxDistanceInPixels === null) ? 200 : settings.maxDistanceInPixels,\n            device: (settings.device === undefined || settings.device === null) ? 0 : settings.device\n        };\n\n        this.imageGroup = [];\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.cap));\n\n        for (var i = 0; i < this.settings.maxDistanceInPixels; i += 100) {\n            this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.body));\n        }\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.base));\n        \n        this.active = true;\n        \n        this.remove();\n    }\n    \n    /**\n     * For create the Joystick\n     * @method create\n     * @param {Array} - Coordinates of pointer.\n     */\n    create({ position }) {\n        if (!this.active) {\n            this.active = true;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = true;\n                sprite.setScrollFactor(0);\n    \n                sprite.x = position.x;\n                sprite.y = position.y;\n                \n            });\n    \n            this.initialPoint = {\n                x: position.x,\n                y: position.y\n            };\n        }\n    }\n\n    /**\n     * To get the cursors attribute\n     * @method getCursors\n     * @return {Object}\n     */\n    getCursors() {\n        return this.cursors;\n    }\n    \n    /**\n     * To define cursors\n     * @method setDirection\n     * @param {Array} - Coordinates of pointer (A Pointer object encapsulates both mouse and touch input within Phaser.)\n     */\n    setDirection(pointers) {\n        if (!this.active) {\n            return;\n        }\n        \n        const pointer = pointers[this.settings.device].position;\n        \n        var deltaX = pointer.x - this.initialPoint.x;\n        var deltaY = pointer.y - this.initialPoint.y;\n        \n        const dist = Math.hypot(deltaX, deltaY);\n        const maxDistanceInPixels = this.settings.maxDistanceInPixels;\n        \n        if (this.settings.singleDirection) {\n            if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                deltaY = 0;\n                pointer.y = this.initialPoint.y;\n            } else {\n                deltaX = 0;\n                pointer.x = this.initialPoint.x;\n            }\n        }\n        \n        const angle = Math.atan2(deltaY, deltaX);\n        \n        if (dist > maxDistanceInPixels) {\n            deltaX = Math.cos(angle) * maxDistanceInPixels;\n            deltaY = Math.sin(angle) * maxDistanceInPixels;\n        }\n        \n        this.cursors = { deltaX, deltaY };\n        \n        this.imageGroup.forEach(function (sprite, index) {\n            sprite.x = this.initialPoint.x + (deltaX) * index / 3;\n            sprite.y = this.initialPoint.y + (deltaY) * index / 3;\n        }, this);\n    }\n    \n    update () {\n        var pointers = this.scene.input.manager.pointers;\n        this.setDirection(pointers);\n    }\n\n    /**\n     * For remove the Joystick\n     * @method remove\n     */\n    remove() {\n        if (this.active) {\n            this.active = false;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = false;\n            });\n\n            this.cursors = {\n                deltaX: 0,\n                deltaY: 0\n            };\n        }\n    }\n}"],"sourceRoot":""}