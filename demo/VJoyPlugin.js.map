{"version":3,"sources":["webpack://VJoyPlugin/webpack/universalModuleDefinition","webpack://VJoyPlugin/webpack/bootstrap","webpack://VJoyPlugin/./main.js","webpack://VJoyPlugin/./Joystick.js"],"names":["VJoyPlugin","scene","pluginManager","joysticks","registerGameObject","addJoystick","bind","config","add","settings","joystickClass","Joystick","joystick","push","eventEmitter","systems","events","on","update","destroy","forEach","game","Phaser","Plugins","ScenePlugin","cursors","up","down","left","right","initialPoint","x","y","singleDirection","undefined","maxDistanceInPixels","device","console","log","imageGroup","sprite","sprites","cap","i","body","base","active","remove","position","visible","setScrollFactor","pointers","pointer","deltaX","deltaY","dist","Math","hypot","abs","angle","atan2","cos","sin","index","input","manager","setDirection"],"mappings":"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","file":"VJoyPlugin.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"VJoyPlugin\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VJoyPlugin\"] = factory();\n\telse\n\t\troot[\"VJoyPlugin\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import Joystick from './Joystick';\n\nexport default class VJoyPlugin extends Phaser.Plugins.ScenePlugin {\n\n    constructor(scene, pluginManager) {\n        super(scene, pluginManager);\n\n        this.joysticks = [];\n\n        // Register our new Game Object type\n        pluginManager.registerGameObject('joystick', this.addJoystick.bind(this), config => {\n            return this.add(\n                config.settings,\n                config.joystickClass\n                );\n            });\n    }\n\n    addJoystick(settings, joystickClass) {\n        if (!joystickClass) {\n            joystickClass = Joystick;\n        }\n\n        const joystick = new joystickClass(this.scene, settings);\n\n        this.joysticks.push(joystick)\n\n        return joystick;\n    }\n\n    /**\n     * If this is a Scene Plugin (i.e. installed into a Scene) then this method is called when the Scene boots.\n     * By this point the plugin properties `scene` and `systems` will have already been set.\n     * In here you can listen for Scene events and set-up whatever you need for this plugin to run.\n     * @returns {void}\n     */\n    boot() {\n        const eventEmitter = this.systems.events;\n\n        eventEmitter.on('update', this.update, this);\n        eventEmitter.on('destroy', this.destroy, this);\n    }\n\n    /**\n     * Internal update method, called by the PluginManager.\n     *\n     * @protected\n     * @returns {void}\n     */\n    update() {\n        this.joysticks.forEach(joystick => {\n            joystick.update();\n        });\n    }\n\n    /**\n     * Destroys this Weapon.\n     * You must release everything in here, all references, all objects, free it all up.\n     * @returns {void}\n     */\n    destroy() {\n        this.pluginManager = null;\n        this.game = null;\n        this.scene = null;\n        this.systems = null;\n    }\n}","export default class Joystick {\n\n    constructor(scene, settings) {\n        this.scene = scene;\n\n        this.cursors = {\n            up: false,\n            down: false,\n            left: false,\n            right: false\n        };\n\n        this.initialPoint = {\n            x: 0,\n            y: 0\n        };\n\n        this.settings = {\n            singleDirection: (settings.singleDirection === undefined || settings.singleDirection === null) ? true : settings.singleDirection,\n            maxDistanceInPixels: (settings.maxDistanceInPixels === undefined || settings.maxDistanceInPixels === null) ? 200 : settings.maxDistanceInPixels,\n            device: (settings.device === undefined || settings.device === null) ? 0 : settings.device\n        };\n\n        console.log(settings, this.settings)\n\n        this.imageGroup = [];\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.cap));\n\n        for (var i = 0; i < this.settings.maxDistanceInPixels; i += 100) {\n            this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.body));\n        }\n        this.imageGroup.push(this.scene.add.sprite(0, 0, settings.sprites.base));\n        \n        this.active = true;\n        \n        this.remove();\n    }\n    \n    /**\n     * For create the Joystick\n     * @method create\n     * @param {Array} - Coordinates of pointer.\n     */\n    create({ position }) {\n        if (!this.active) {\n            this.active = true;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = true;\n                sprite.setScrollFactor(0);\n    \n                sprite.x = position.x;\n                sprite.y = position.y;\n                \n            });\n    \n            this.initialPoint = {\n                x: position.x,\n                y: position.y\n            };\n        }\n    }\n\n    /**\n     * To get the cursors attribute\n     * @method getCursors\n     * @return {Object}\n     */\n    getCursors() {\n        return this.cursors;\n    }\n    \n    /**\n     * To define cursors\n     * @method setDirection\n     * @param {Array} - Coordinates of pointer (A Pointer object encapsulates both mouse and touch input within Phaser.)\n     */\n    setDirection(pointers) {\n        if (!this.active) {\n            return;\n        }\n        \n        var pointer = pointers[this.settings.device].position;\n        \n        var deltaX = pointer.x - this.initialPoint.x;\n        var deltaY = pointer.y - this.initialPoint.y;\n        \n        var dist = Math.hypot(deltaX, deltaY);\n        var maxDistanceInPixels = this.settings.maxDistanceInPixels;\n        \n        if (this.settings.singleDirection) {\n            if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                deltaY = 0;\n                pointer.y = this.initialPoint.y;\n            } else {\n                deltaX = 0;\n                pointer.x = this.initialPoint.x;\n            }\n        }\n        \n        var angle = Math.atan2(deltaY, deltaX);\n        \n        if (dist > maxDistanceInPixels) {\n            deltaX = Math.cos(angle) * maxDistanceInPixels;\n            deltaY = Math.sin(angle) * maxDistanceInPixels;\n        }\n        \n        this.cursors = {\n            up: (deltaY < 0),\n            down: (deltaY > 0),\n            left: (deltaX < 0),\n            right: (deltaX > 0)\n        }\n        \n        this.imageGroup.forEach(function (sprite, index) {\n            sprite.x = this.initialPoint.x + (deltaX) * index / 3;\n            sprite.y = this.initialPoint.y + (deltaY) * index / 3;\n        }, this);\n    }\n    \n    update () {\n        var pointers = this.scene.input.manager.pointers;\n        this.setDirection(pointers);\n    }\n\n    /**\n     * For remove the Joystick\n     * @method remove\n     */\n    remove() {\n        if (this.active) {\n            this.active = false;\n\n            this.imageGroup.forEach(sprite => {\n                sprite.visible = false;\n            });\n\n            this.cursors = {\n                up: false,\n                down: false,\n                left: false,\n                right: false\n            };\n        }\n    }\n}"],"sourceRoot":""}